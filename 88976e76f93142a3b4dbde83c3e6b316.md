# **Project Wrangling dan SQL**
- Nama    : Riyan Zaenal Arifin
- Email   : riyanzaenal411@gmail.com

## **Import library yang diperlukan**
``` python
import sqlite3
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
```
## **Masukan path file database**
 ``` python
 sqliteConnection = sqlite3.connect('D:/Desktop/Data Science/PacmannAI/Wrangling and SQL/olist.db')
```
## **Melihat table yang ada di database**
``` python
table = pd.read_sql_query("SELECT name FROM sqlite_master WHERE type='table';", sqliteConnection)
table
```

## **Eksplorasi table**
``` python
table = pd.read_sql_query("SELECT * FROM olist_order_customer_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM olist_order_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM olist_order_reviews_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM olist_order_payments_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM olist_order_items_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM olist_products_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM olist_sellers_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM olist_geolocation_dataset;", sqliteConnection)
table
```

``` python
table = pd.read_sql_query("SELECT * FROM product_category_name_translation;", sqliteConnection)
table
```


## **MENENTUKAN OBJEKTIVE**

Dalam menentukan objektive ini juga dilakukan proses cleaning dan
visaualisasi untuk setiap objektive. Untuk proses data cleaning pada
data data outlier tidak dilakukan karena seluruh objektive menggunakan
frekuensi kemunculan dari sebuah data, jika dihilangkan ditakutkan akan
mengurangi informasi terkait frekuensi terendah sehingga ditakutkan
kesalahan dalam mengambil sebuah keputusan

### **1. Perusahaan ingin melihat kategori produk yang paling banyak diorder oleh customer** {#1-perusahaan-ingin-melihat-kategori-produk-yang-paling-banyak-diorder-oleh-customer}

#### **a. Query SQL** {#a-query-sql}
:::

::: {.cell .code execution_count="48"}
``` python
objektive1 = pd.read_sql_query(
    "with orderr as(select product_category_name, count(product_id) as jumlah_order from olist_products_dataset inner join olist_order_items_dataset using(product_id) group by product_category_name) select * from orderr order by jumlah_order desc;"
    , sqliteConnection)
objektive1
```

::: {.output .execute_result execution_count="48"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_category_name</th>
      <th>jumlah_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cama_mesa_banho</td>
      <td>11115</td>
    </tr>
    <tr>
      <th>1</th>
      <td>beleza_saude</td>
      <td>9670</td>
    </tr>
    <tr>
      <th>2</th>
      <td>esporte_lazer</td>
      <td>8641</td>
    </tr>
    <tr>
      <th>3</th>
      <td>moveis_decoracao</td>
      <td>8334</td>
    </tr>
    <tr>
      <th>4</th>
      <td>informatica_acessorios</td>
      <td>7827</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>69</th>
      <td>cds_dvds_musicais</td>
      <td>14</td>
    </tr>
    <tr>
      <th>70</th>
      <td>la_cuisine</td>
      <td>14</td>
    </tr>
    <tr>
      <th>71</th>
      <td>pc_gamer</td>
      <td>9</td>
    </tr>
    <tr>
      <th>72</th>
      <td>fashion_roupa_infanto_juvenil</td>
      <td>8</td>
    </tr>
    <tr>
      <th>73</th>
      <td>seguros_e_servicos</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>74 rows Ã— 2 columns</p>
</div>
```
:::
:::

::: {.cell .markdown}
#### **b. Data Cleaning** {#b-data-cleaning}
:::

::: {.cell .markdown}
##### 1. cek dan hapus missing {#1-cek-dan-hapus-missing}
:::

::: {.cell .code execution_count="69"}
``` python
missing_values = ["", " ", "None", "none"] #definisikan nilai missing yang mungkin terjadi
col_names = objektive1.columns
objektive1[col_names] = objektive1[col_names].replace(missing_values, np.nan)
objektive1.isna().sum()
```

::: {.output .execute_result execution_count="69"}
    product_category_name    1
    jumlah_order             0
    dtype: int64
:::
:::

::: {.cell .code execution_count="71"}
``` python
objektive1 = objektive1.dropna()
objektive1.isna().sum()
```

::: {.output .execute_result execution_count="71"}
    product_category_name    0
    jumlah_order             0
    dtype: int64
:::
:::

::: {.cell .markdown}
##### 2. cek duplikasi data {#2-cek-duplikasi-data}
:::

::: {.cell .code execution_count="73"}
``` python
objektive1.duplicated().sum()
```

::: {.output .execute_result execution_count="73"}
    0
:::
:::

::: {.cell .markdown}
##### 3. Cek inkonsisten format atau tipe daya {#3-cek-inkonsisten-format-atau-tipe-daya}
:::

::: {.cell .code execution_count="68"}
``` python
objektive1['product_category_name'].unique()
```

::: {.output .execute_result execution_count="68"}
    array(['cama_mesa_banho', 'beleza_saude', 'esporte_lazer',
           'moveis_decoracao', 'informatica_acessorios',
           'utilidades_domesticas', 'relogios_presentes', 'telefonia',
           'ferramentas_jardim', 'automotivo', 'brinquedos', 'cool_stuff',
           'perfumaria', 'bebes', 'eletronicos', 'papelaria',
           'fashion_bolsas_e_acessorios', 'pet_shop', 'moveis_escritorio',
           None, 'consoles_games', 'malas_acessorios',
           'construcao_ferramentas_construcao', 'eletrodomesticos',
           'instrumentos_musicais', 'eletroportateis', 'casa_construcao',
           'livros_interesse_geral', 'alimentos', 'moveis_sala',
           'casa_conforto', 'bebidas', 'audio', 'market_place',
           'construcao_ferramentas_iluminacao', 'climatizacao',
           'moveis_cozinha_area_de_servico_jantar_e_jardim',
           'alimentos_bebidas', 'industria_comercio_e_negocios',
           'livros_tecnicos', 'telefonia_fixa', 'fashion_calcados',
           'construcao_ferramentas_jardim', 'eletrodomesticos_2',
           'agro_industria_e_comercio', 'artes', 'pcs',
           'sinalizacao_e_seguranca', 'construcao_ferramentas_seguranca',
           'artigos_de_natal', 'fashion_roupa_masculina',
           'fashion_underwear_e_moda_praia', 'moveis_quarto',
           'construcao_ferramentas_ferramentas', 'tablets_impressao_imagem',
           'portateis_casa_forno_e_cafe', 'cine_foto', 'dvds_blu_ray',
           'livros_importados', 'fashion_roupa_feminina', 'artigos_de_festas',
           'fraldas_higiene', 'moveis_colchao_e_estofado', 'musica', 'flores',
           'casa_conforto_2', 'fashion_esporte', 'artes_e_artesanato',
           'portateis_cozinha_e_preparadores_de_alimentos',
           'cds_dvds_musicais', 'la_cuisine', 'pc_gamer',
           'fashion_roupa_infanto_juvenil', 'seguros_e_servicos'],
          dtype=object)
:::
:::

::: {.cell .markdown}
#### **c. Visualization** {#c-visualization}
:::

::: {.cell .code execution_count="186"}
``` python
objektive1.plot.bar(x='product_category_name', color="orange")
```

::: {.output .execute_result execution_count="186"}
    <AxesSubplot:xlabel='product_category_name'>
:::

::: {.output .display_data}
![](vertopal_88976e76f93142a3b4dbde83c3e6b316/93e0be75b6aa06bc124e65d1c66f76ee22be8545.png)
:::
:::

::: {.cell .markdown}
### **2. Perusahaan ingin melihat 15 kategori produk yang memiliki omzet paling tinggi** {#2-perusahaan-ingin-melihat-15-kategori-produk-yang-memiliki-omzet-paling-tinggi}
:::

::: {.cell .code execution_count="84"}
``` python
objektive2 = pd.read_sql_query(
    "with omzet as(select product_category_name, sum(price) as banyak_omzet from olist_products_dataset inner join olist_order_items_dataset using(product_id) group by product_category_name) select * from omzet order by banyak_omzet desc limit 15;"
    , sqliteConnection)
objektive2
```

::: {.output .execute_result execution_count="84"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_category_name</th>
      <th>banyak_omzet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>beleza_saude</td>
      <td>1258681.34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>relogios_presentes</td>
      <td>1205005.68</td>
    </tr>
    <tr>
      <th>2</th>
      <td>cama_mesa_banho</td>
      <td>1036988.68</td>
    </tr>
    <tr>
      <th>3</th>
      <td>esporte_lazer</td>
      <td>988048.97</td>
    </tr>
    <tr>
      <th>4</th>
      <td>informatica_acessorios</td>
      <td>911954.32</td>
    </tr>
    <tr>
      <th>5</th>
      <td>moveis_decoracao</td>
      <td>729762.49</td>
    </tr>
    <tr>
      <th>6</th>
      <td>cool_stuff</td>
      <td>635290.85</td>
    </tr>
    <tr>
      <th>7</th>
      <td>utilidades_domesticas</td>
      <td>632248.66</td>
    </tr>
    <tr>
      <th>8</th>
      <td>automotivo</td>
      <td>592720.11</td>
    </tr>
    <tr>
      <th>9</th>
      <td>ferramentas_jardim</td>
      <td>485256.46</td>
    </tr>
    <tr>
      <th>10</th>
      <td>brinquedos</td>
      <td>483946.60</td>
    </tr>
    <tr>
      <th>11</th>
      <td>bebes</td>
      <td>411764.89</td>
    </tr>
    <tr>
      <th>12</th>
      <td>perfumaria</td>
      <td>399124.87</td>
    </tr>
    <tr>
      <th>13</th>
      <td>telefonia</td>
      <td>323667.53</td>
    </tr>
    <tr>
      <th>14</th>
      <td>moveis_escritorio</td>
      <td>273960.70</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .markdown}
#### **b. Data Cleaning** {#b-data-cleaning}
:::

::: {.cell .markdown}
##### 1. cek dan hapus missing {#1-cek-dan-hapus-missing}
:::

::: {.cell .code execution_count="86"}
``` python
missing_values = ["", " ", "None", "none"] #definisikan nilai missing yang mungkin terjadi
col_names = objektive2.columns
objektive2[col_names] = objektive2[col_names].replace(missing_values, np.nan)
objektive2.isna().sum()
```

::: {.output .execute_result execution_count="86"}
    product_category_name    0
    banyak_omzet             0
    dtype: int64
:::
:::

::: {.cell .code execution_count="87"}
``` python
objektive2 = objektive2.dropna()
objektive2.isna().sum()
```

::: {.output .execute_result execution_count="87"}
    product_category_name    0
    banyak_omzet             0
    dtype: int64
:::
:::

::: {.cell .markdown}
##### 2. cek duplikasi data {#2-cek-duplikasi-data}
:::

::: {.cell .code execution_count="115"}
``` python
objektive2.duplicated().sum()
```

::: {.output .execute_result execution_count="115"}
    0
:::
:::

::: {.cell .markdown}
##### 3. Cek inkonsisten format atau tipe daya {#3-cek-inkonsisten-format-atau-tipe-daya}
:::

::: {.cell .code execution_count="90"}
``` python
objektive2['product_category_name'].unique()
```

::: {.output .execute_result execution_count="90"}
    array(['beleza_saude', 'relogios_presentes', 'cama_mesa_banho',
           'esporte_lazer', 'informatica_acessorios', 'moveis_decoracao',
           'cool_stuff', 'utilidades_domesticas', 'automotivo',
           'ferramentas_jardim', 'brinquedos', 'bebes', 'perfumaria',
           'telefonia', 'moveis_escritorio'], dtype=object)
:::
:::

::: {.cell .markdown}
#### **c. Visualization** {#c-visualization}
:::

::: {.cell .code execution_count="105"}
``` python
objektive2.plot.bar(x='product_category_name', color="blue")
```

::: {.output .execute_result execution_count="105"}
    <AxesSubplot:xlabel='product_category_name'>
:::

::: {.output .display_data}
![](vertopal_88976e76f93142a3b4dbde83c3e6b316/75fa2a4342a502a5b1c82e62b960d9cc7e7235c2.png)
:::
:::

::: {.cell .markdown}
### **3. Perusahaan ingin melihat 20 kota teratas yang memiliki jumlah penjualan tertinggi** {#3-perusahaan-ingin-melihat-20-kota-teratas-yang-memiliki-jumlah-penjualan-tertinggi}
:::

::: {.cell .code execution_count="50"}
``` python
objektive3 = pd.read_sql_query(
    "SELECT customer_city, customer_state, count(customer_city) as jumlah_penjualan FROM olist_order_customer_dataset inner join olist_order_dataset using(customer_id) join olist_order_items_dataset using(order_id) group by customer_city order by jumlah_penjualan desc limit 20;"
    , sqliteConnection)
objektive3
```

::: {.output .execute_result execution_count="50"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customer_city</th>
      <th>customer_state</th>
      <th>jumlah_penjualan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sao paulo</td>
      <td>SP</td>
      <td>17808</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rio de janeiro</td>
      <td>RJ</td>
      <td>7837</td>
    </tr>
    <tr>
      <th>2</th>
      <td>belo horizonte</td>
      <td>MG</td>
      <td>3144</td>
    </tr>
    <tr>
      <th>3</th>
      <td>brasilia</td>
      <td>DF</td>
      <td>2392</td>
    </tr>
    <tr>
      <th>4</th>
      <td>curitiba</td>
      <td>PR</td>
      <td>1751</td>
    </tr>
    <tr>
      <th>5</th>
      <td>campinas</td>
      <td>SP</td>
      <td>1654</td>
    </tr>
    <tr>
      <th>6</th>
      <td>porto alegre</td>
      <td>RS</td>
      <td>1612</td>
    </tr>
    <tr>
      <th>7</th>
      <td>salvador</td>
      <td>BA</td>
      <td>1412</td>
    </tr>
    <tr>
      <th>8</th>
      <td>guarulhos</td>
      <td>SP</td>
      <td>1329</td>
    </tr>
    <tr>
      <th>9</th>
      <td>sao bernardo do campo</td>
      <td>SP</td>
      <td>1060</td>
    </tr>
    <tr>
      <th>10</th>
      <td>niteroi</td>
      <td>RJ</td>
      <td>980</td>
    </tr>
    <tr>
      <th>11</th>
      <td>santo andre</td>
      <td>SP</td>
      <td>891</td>
    </tr>
    <tr>
      <th>12</th>
      <td>osasco</td>
      <td>SP</td>
      <td>850</td>
    </tr>
    <tr>
      <th>13</th>
      <td>santos</td>
      <td>SP</td>
      <td>820</td>
    </tr>
    <tr>
      <th>14</th>
      <td>goiania</td>
      <td>GO</td>
      <td>817</td>
    </tr>
    <tr>
      <th>15</th>
      <td>sao jose dos campos</td>
      <td>SP</td>
      <td>781</td>
    </tr>
    <tr>
      <th>16</th>
      <td>fortaleza</td>
      <td>CE</td>
      <td>728</td>
    </tr>
    <tr>
      <th>17</th>
      <td>sorocaba</td>
      <td>SP</td>
      <td>703</td>
    </tr>
    <tr>
      <th>18</th>
      <td>recife</td>
      <td>PE</td>
      <td>677</td>
    </tr>
    <tr>
      <th>19</th>
      <td>florianopolis</td>
      <td>SC</td>
      <td>660</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .markdown}
#### **b. Data Cleaning** {#b-data-cleaning}
:::

::: {.cell .markdown}
##### 1. cek dan hapus missing {#1-cek-dan-hapus-missing}
:::

::: {.cell .code execution_count="106"}
``` python
missing_values = ["", " ", "None", "none"] #definisikan nilai missing yang mungkin terjadi
col_names = objektive3.columns
objektive3[col_names] = objektive3[col_names].replace(missing_values, np.nan)
objektive3.isna().sum()
```

::: {.output .execute_result execution_count="106"}
    customer_city       0
    customer_state      0
    jumlah_penjualan    0
    dtype: int64
:::
:::

::: {.cell .code execution_count="107"}
``` python
objektive3 = objektive3.dropna()
objektive3.isna().sum()
```

::: {.output .execute_result execution_count="107"}
    customer_city       0
    customer_state      0
    jumlah_penjualan    0
    dtype: int64
:::
:::

::: {.cell .markdown}
##### 2. cek duplikasi data {#2-cek-duplikasi-data}
:::

::: {.cell .code execution_count="108"}
``` python
objektive3.duplicated().sum()
```

::: {.output .execute_result execution_count="108"}
    0
:::
:::

::: {.cell .markdown}
##### 3. Cek inkonsisten format atau tipe daya {#3-cek-inkonsisten-format-atau-tipe-daya}
:::

::: {.cell .code execution_count="121"}
``` python
objektive3['customer_city'].unique()
```

::: {.output .execute_result execution_count="121"}
    array(['sao paulo', 'rio de janeiro', 'belo horizonte', 'brasilia',
           'curitiba', 'campinas', 'porto alegre', 'salvador', 'guarulhos',
           'sao bernardo do campo', 'niteroi', 'santo andre', 'osasco',
           'santos', 'goiania', 'sao jose dos campos', 'fortaleza',
           'sorocaba', 'recife', 'florianopolis'], dtype=object)
:::
:::

::: {.cell .code execution_count="122"}
``` python
objektive3['customer_state'].unique()
```

::: {.output .execute_result execution_count="122"}
    array(['SP', 'RJ', 'MG', 'DF', 'PR', 'RS', 'BA', 'GO', 'CE', 'PE', 'SC'],
          dtype=object)
:::
:::

::: {.cell .markdown}
#### **c. Visualization** {#c-visualization}
:::

::: {.cell .code execution_count="124"}
``` python
objektive3.plot.bar(x='customer_city', color="green")
```

::: {.output .execute_result execution_count="124"}
    <AxesSubplot:xlabel='customer_city'>
:::

::: {.output .display_data}
![](vertopal_88976e76f93142a3b4dbde83c3e6b316/a3527ba04adc75aed5b794f5983e2eac7dcec790.png)
:::
:::

::: {.cell .markdown}
### **4. Perusahaan ingin melihat jumlah penjualan terbanyak dari 20 kategori produk teratas di kota sao paulo** {#4-perusahaan-ingin-melihat-jumlah-penjualan-terbanyak-dari-20-kategori-produk-teratas-di-kota-sao-paulo}
:::

::: {.cell .code execution_count="46"}
``` python
objektive4 = pd.read_sql_query(
    "with orderl as(select product_category_name, count(order_id) as banyak_order from olist_order_customer_dataset join olist_order_dataset using(customer_id) join olist_order_items_dataset using(order_id) join olist_products_dataset using(product_id) where customer_city = 'sao paulo' group by product_category_name) select * from orderl order by banyak_order desc limit 20;"
    , sqliteConnection)
objektive4
```

::: {.output .execute_result execution_count="46"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_category_name</th>
      <th>banyak_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>cama_mesa_banho</td>
      <td>1984</td>
    </tr>
    <tr>
      <th>1</th>
      <td>beleza_saude</td>
      <td>1753</td>
    </tr>
    <tr>
      <th>2</th>
      <td>esporte_lazer</td>
      <td>1397</td>
    </tr>
    <tr>
      <th>3</th>
      <td>utilidades_domesticas</td>
      <td>1321</td>
    </tr>
    <tr>
      <th>4</th>
      <td>moveis_decoracao</td>
      <td>1268</td>
    </tr>
    <tr>
      <th>5</th>
      <td>informatica_acessorios</td>
      <td>1227</td>
    </tr>
    <tr>
      <th>6</th>
      <td>relogios_presentes</td>
      <td>844</td>
    </tr>
    <tr>
      <th>7</th>
      <td>brinquedos</td>
      <td>658</td>
    </tr>
    <tr>
      <th>8</th>
      <td>telefonia</td>
      <td>620</td>
    </tr>
    <tr>
      <th>9</th>
      <td>automotivo</td>
      <td>555</td>
    </tr>
    <tr>
      <th>10</th>
      <td>perfumaria</td>
      <td>549</td>
    </tr>
    <tr>
      <th>11</th>
      <td>bebes</td>
      <td>489</td>
    </tr>
    <tr>
      <th>12</th>
      <td>ferramentas_jardim</td>
      <td>472</td>
    </tr>
    <tr>
      <th>13</th>
      <td>cool_stuff</td>
      <td>445</td>
    </tr>
    <tr>
      <th>14</th>
      <td>papelaria</td>
      <td>379</td>
    </tr>
    <tr>
      <th>15</th>
      <td>eletronicos</td>
      <td>357</td>
    </tr>
    <tr>
      <th>16</th>
      <td>fashion_bolsas_e_acessorios</td>
      <td>323</td>
    </tr>
    <tr>
      <th>17</th>
      <td>pet_shop</td>
      <td>306</td>
    </tr>
    <tr>
      <th>18</th>
      <td>None</td>
      <td>295</td>
    </tr>
    <tr>
      <th>19</th>
      <td>moveis_escritorio</td>
      <td>242</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .markdown}
#### **b. Data Cleaning** {#b-data-cleaning}
:::

::: {.cell .markdown}
##### 1. cek dan hapus missing {#1-cek-dan-hapus-missing}
:::

::: {.cell .code execution_count="125"}
``` python
missing_values = ["", " ", "None", "none"] #definisikan nilai missing yang mungkin terjadi
col_names = objektive4.columns
objektive4[col_names] = objektive4[col_names].replace(missing_values, np.nan)
objektive4.isna().sum()
```

::: {.output .execute_result execution_count="125"}
    product_category_name    1
    banyak_order             0
    dtype: int64
:::
:::

::: {.cell .code execution_count="126"}
``` python
objektive4 = objektive4.dropna()
objektive4.isna().sum()
```

::: {.output .execute_result execution_count="126"}
    product_category_name    0
    banyak_order             0
    dtype: int64
:::
:::

::: {.cell .markdown}
##### 2. cek duplikasi data {#2-cek-duplikasi-data}
:::

::: {.cell .code execution_count="137"}
``` python
objektive4.duplicated().sum()
```

::: {.output .execute_result execution_count="137"}
    0
:::
:::

::: {.cell .markdown}
##### 3. Cek inkonsisten format atau tipe daya {#3-cek-inkonsisten-format-atau-tipe-daya}
:::

::: {.cell .code execution_count="129"}
``` python
objektive4['product_category_name'].unique()
```

::: {.output .execute_result execution_count="129"}
    array(['cama_mesa_banho', 'beleza_saude', 'esporte_lazer',
           'utilidades_domesticas', 'moveis_decoracao',
           'informatica_acessorios', 'relogios_presentes', 'brinquedos',
           'telefonia', 'automotivo', 'perfumaria', 'bebes',
           'ferramentas_jardim', 'cool_stuff', 'papelaria', 'eletronicos',
           'fashion_bolsas_e_acessorios', 'pet_shop', 'moveis_escritorio'],
          dtype=object)
:::
:::

::: {.cell .markdown}
#### **c. Visualization** {#c-visualization}
:::

::: {.cell .code execution_count="132"}
``` python
objektive4.plot.bar(x='product_category_name', color="red")
```

::: {.output .execute_result execution_count="132"}
    <AxesSubplot:xlabel='product_category_name'>
:::

::: {.output .display_data}
![](vertopal_88976e76f93142a3b4dbde83c3e6b316/bc857768da9be98d4002571d8d98e8ac5d09364d.png)
:::
:::

::: {.cell .markdown}
### **5. Perusahaan ingin melihat jumlah dari setiap status order di kota sao paulo** {#5-perusahaan-ingin-melihat-jumlah-dari-setiap-status-order-di-kota-sao-paulo}
:::

::: {.cell .code execution_count="38"}
``` python
objektive5 = pd.read_sql_query(
    "with state as(select olist_order_dataset.order_status, customer_city from olist_order_customer_dataset inner join olist_order_dataset using(customer_id)) select order_status, count(customer_city) as jumlah from state where customer_city = 'sao paulo' group by order_status order by jumlah desc;"
    , sqliteConnection)
objektive5
```

::: {.output .execute_result execution_count="38"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_status</th>
      <th>jumlah</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>delivered</td>
      <td>15045</td>
    </tr>
    <tr>
      <th>1</th>
      <td>shipped</td>
      <td>141</td>
    </tr>
    <tr>
      <th>2</th>
      <td>canceled</td>
      <td>140</td>
    </tr>
    <tr>
      <th>3</th>
      <td>unavailable</td>
      <td>109</td>
    </tr>
    <tr>
      <th>4</th>
      <td>processing</td>
      <td>52</td>
    </tr>
    <tr>
      <th>5</th>
      <td>invoiced</td>
      <td>52</td>
    </tr>
    <tr>
      <th>6</th>
      <td>approved</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .markdown}
#### **b. Data Cleaning** {#b-data-cleaning}
:::

::: {.cell .markdown}
##### 1. cek dan hapus missing {#1-cek-dan-hapus-missing}
:::

::: {.cell .code execution_count="134"}
``` python
missing_values = ["", " ", "None", "none"] #definisikan nilai missing yang mungkin terjadi
col_names = objektive5.columns
objektive5[col_names] = objektive5[col_names].replace(missing_values, np.nan)
objektive5.isna().sum()
```

::: {.output .execute_result execution_count="134"}
    order_status    0
    jumlah          0
    dtype: int64
:::
:::

::: {.cell .code execution_count="135"}
``` python
objektive5 = objektive5.dropna()
objektive5.isna().sum()
```

::: {.output .execute_result execution_count="135"}
    order_status    0
    jumlah          0
    dtype: int64
:::
:::

::: {.cell .markdown}
##### 2. cek duplikasi data {#2-cek-duplikasi-data}
:::

::: {.cell .code execution_count="136"}
``` python
objektive5.duplicated().sum()
```

::: {.output .execute_result execution_count="136"}
    0
:::
:::

::: {.cell .markdown}
##### 3. Cek inkonsisten format atau tipe daya {#3-cek-inkonsisten-format-atau-tipe-daya}
:::

::: {.cell .code execution_count="138"}
``` python
objektive5['order_status'].unique()
```

::: {.output .execute_result execution_count="138"}
    array(['delivered', 'shipped', 'canceled', 'unavailable', 'processing',
           'invoiced', 'approved'], dtype=object)
:::
:::

::: {.cell .markdown}
#### **c. Visualization** {#c-visualization}
:::

::: {.cell .code execution_count="142"}
``` python
objektive5.plot.bar(x='order_status', color="violet")
```

::: {.output .execute_result execution_count="142"}
    <AxesSubplot:xlabel='order_status'>
:::

::: {.output .display_data}
![](vertopal_88976e76f93142a3b4dbde83c3e6b316/3dffa527eba38ad3f6f577a8e3d1d06a2400311c.png)
:::
:::

::: {.cell .markdown}
### **6. Perusahaan ingin melihat jumlah dari tiap metode pembayaran di kota sao paulo** {#6-perusahaan-ingin-melihat-jumlah-dari-tiap-metode-pembayaran-di-kota-sao-paulo}
:::

::: {.cell .code execution_count="41"}
``` python
#perusahaan ingin melihat metode pembayaran yang di lakukan oleh customer di kota sao paulo
objektive6 = pd.read_sql_query(
    "with state as(select payment_type, count(olist_order_payments_dataset.payment_type) as jumlah from olist_order_customer_dataset inner join olist_order_dataset using(customer_id) join olist_order_payments_dataset using(order_id) where olist_order_customer_dataset.customer_city = 'sao paulo' group by payment_type) select * from state order by jumlah desc;"
    , sqliteConnection)
objektive6
```

::: {.output .execute_result execution_count="41"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>payment_type</th>
      <th>jumlah</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>credit_card</td>
      <td>12226</td>
    </tr>
    <tr>
      <th>1</th>
      <td>boleto</td>
      <td>2783</td>
    </tr>
    <tr>
      <th>2</th>
      <td>voucher</td>
      <td>914</td>
    </tr>
    <tr>
      <th>3</th>
      <td>debit_card</td>
      <td>295</td>
    </tr>
    <tr>
      <th>4</th>
      <td>not_defined</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .markdown}
#### **b. Data Cleaning** {#b-data-cleaning}
:::

::: {.cell .markdown}
##### 1. cek dan hapus missing {#1-cek-dan-hapus-missing}
:::

::: {.cell .code execution_count="143"}
``` python
missing_values = ["", " ", "None", "none"] #definisikan nilai missing yang mungkin terjadi
col_names = objektive6.columns
objektive6[col_names] = objektive6[col_names].replace(missing_values, np.nan)
objektive6.isna().sum()
```

::: {.output .execute_result execution_count="143"}
    payment_type    0
    jumlah          0
    dtype: int64
:::
:::

::: {.cell .code execution_count="144"}
``` python
objektive6 = objektive6.dropna()
objektive6.isna().sum()
```

::: {.output .execute_result execution_count="144"}
    payment_type    0
    jumlah          0
    dtype: int64
:::
:::

::: {.cell .markdown}
##### 2. cek duplikasi data {#2-cek-duplikasi-data}
:::

::: {.cell .code execution_count="145"}
``` python
objektive6.duplicated().sum()
```

::: {.output .execute_result execution_count="145"}
    0
:::
:::

::: {.cell .markdown}
##### 3. Cek inkonsisten format atau tipe daya {#3-cek-inkonsisten-format-atau-tipe-daya}
:::

::: {.cell .code execution_count="146"}
``` python
objektive6['payment_type'].unique()
```

::: {.output .execute_result execution_count="146"}
    array(['credit_card', 'boleto', 'voucher', 'debit_card', 'not_defined'],
          dtype=object)
:::
:::

::: {.cell .markdown}
#### **c. Visualization** {#c-visualization}
:::

::: {.cell .code execution_count="174"}
``` python
# define Seaborn color palette to use
palette_color = sns.color_palette('bright')[0:10]
  
# plotting data on chart
plt.pie(objektive6['jumlah'], labels=objektive6['payment_type'], colors=palette_color, textprops = {"fontsize":18}, radius = 6.2)
  
# displaying chart
plt.show()
```

::: {.output .display_data}
![](vertopal_88976e76f93142a3b4dbde83c3e6b316/2e4430885cab24e50edbb44b498698760555c2b1.png)
:::
:::

::: {.cell .markdown}
### **7. perusahaan ingin melihat 10 penjual yang menjual barang paling banyak** {#7-perusahaan-ingin-melihat-10-penjual-yang-menjual-barang-paling-banyak}
:::

::: {.cell .code execution_count="44"}
``` python
objektive7 = pd.read_sql_query(
    "with seller as(select seller_id, seller_city, seller_state, count(seller_id) as count_sale from olist_sellers_dataset inner join olist_order_items_dataset using(seller_id) group by seller_id) select * from seller order by count_sale desc limit 10;"
    , sqliteConnection)
objektive7
```

::: {.output .execute_result execution_count="44"}
```{=html}
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>seller_id</th>
      <th>seller_city</th>
      <th>seller_state</th>
      <th>count_sale</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6560211a19b47992c3666cc44a7e94c0</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>2033</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4a3ca9315b744ce9f8e9374361493884</td>
      <td>ibitinga</td>
      <td>SP</td>
      <td>1987</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1f50f920176fa81dab994f9023523100</td>
      <td>sao jose do rio preto</td>
      <td>SP</td>
      <td>1931</td>
    </tr>
    <tr>
      <th>3</th>
      <td>cc419e0650a3c5ba77189a1882b7556a</td>
      <td>santo andre</td>
      <td>SP</td>
      <td>1775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>da8622b14eb17ae2831f4ac5b9dab84a</td>
      <td>piracicaba</td>
      <td>SP</td>
      <td>1551</td>
    </tr>
    <tr>
      <th>5</th>
      <td>955fee9216a65b617aa5c0531780ce60</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>1499</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1025f0e2d44d7041d6cf58b6550e0bfa</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>1428</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7c67e1448b00f6e969d365cea6b010ab</td>
      <td>itaquaquecetuba</td>
      <td>SP</td>
      <td>1364</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ea8482cd71df3c1969d7b9473ff13abc</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>1203</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7a67c85e85bb2ce8582c35f2203ad736</td>
      <td>sao paulo</td>
      <td>SP</td>
      <td>1171</td>
    </tr>
  </tbody>
</table>
</div>
```
:::
:::

::: {.cell .markdown}
#### **b. Data Cleaning** {#b-data-cleaning}
:::

::: {.cell .markdown}
##### 1. cek dan hapus missing {#1-cek-dan-hapus-missing}
:::

::: {.cell .code execution_count="175"}
``` python
missing_values = ["", " ", "None", "none"] #definisikan nilai missing yang mungkin terjadi
col_names = objektive7.columns
objektive7[col_names] = objektive7[col_names].replace(missing_values, np.nan)
objektive7.isna().sum()
```

::: {.output .execute_result execution_count="175"}
    seller_id       0
    seller_city     0
    seller_state    0
    count_sale      0
    dtype: int64
:::
:::

::: {.cell .code execution_count="176"}
``` python
objektive7 = objektive7.dropna()
objektive7.isna().sum()
```

::: {.output .execute_result execution_count="176"}
    seller_id       0
    seller_city     0
    seller_state    0
    count_sale      0
    dtype: int64
:::
:::

::: {.cell .markdown}
##### 2. cek duplikasi data {#2-cek-duplikasi-data}
:::

::: {.cell .code execution_count="177"}
``` python
objektive7.duplicated().sum()
```

::: {.output .execute_result execution_count="177"}
    0
:::
:::

::: {.cell .markdown}
##### 3. Cek inkonsisten format atau tipe daya {#3-cek-inkonsisten-format-atau-tipe-daya}
:::

::: {.cell .code execution_count="178"}
``` python
objektive7['seller_city'].unique()
```

::: {.output .execute_result execution_count="178"}
    array(['sao paulo', 'ibitinga', 'sao jose do rio preto', 'santo andre',
           'piracicaba', 'itaquaquecetuba'], dtype=object)
:::
:::

::: {.cell .code execution_count="179"}
``` python
objektive7['seller_state'].unique()
```

::: {.output .execute_result execution_count="179"}
    array(['SP'], dtype=object)
:::
:::

::: {.cell .markdown}
#### **c. Visualization** {#c-visualization}
:::

::: {.cell .code execution_count="181"}
``` python
objektive7.plot.bar(x='seller_id', color="black")
```

::: {.output .execute_result execution_count="181"}
    <AxesSubplot:xlabel='seller_id'>
:::

::: {.output .display_data}
![](vertopal_88976e76f93142a3b4dbde83c3e6b316/a1aa4310564f62fc4401c8afc7f70f31808596e8.png)
:::
:::
